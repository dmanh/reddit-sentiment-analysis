library(ibmdbR)
mycon <- idaConnect("BLUDB", "", "")
idaInit(mycon)

#emotions <- c('"Agreeableness"', '"Analytical"','"Anger"','"Cheerfulness"','"Confident"','"Conscientiousness"','"Negative"','"Openness"','"Tentative"')

emotions <- c('AGREEABLENESS', 'ANALYTICAL', 'ANGER', 'CONFIDENT', 'CONSCIENTIOUSNESS', 'DISGUST', 'EMOTIONAL_RANGE', 'EXTRAVERSION', 'FEAR', 'JOY', 'OPENNESS', 'SADNESS', 'TENTATIVE')
displaynames <- c('AGREEABLE', 'ANALYTICAL', 'ANGER', 'CONFIDENT', 'CONSCIENTIOUS', 'DISGUST', 'EMO RANGE', 'XVERSION', 'FEAR', 'JOY', 'OPEN', 'SAD', 'TENTATIVE')

count <- list()
print("Length of emotions ", length(emotions))
for(i in 1:13){
  query <- paste('select count(*) from DASH014376."REDDIT_IBMAMA_TOP_COMMENTS_ONLY" where ',emotions[i],' > 70')

df <- idaQuery(query,as.is=F)
nrow(df) 
ncol(df) 
df
count[[i]] <- df[1,]
}
count
sink('/dev/null') 
distribution <- unlist(count)

barplot(distribution,main="Histogram of comments by sentiments > 70% in IBM Reddit AMA",names.arg=displaynames, col=139, cex.axis=0.8,cex.names=0.7,xlab="Tone",ylab="Count")

sink('/dev/null') 
idaClose(mycon)


